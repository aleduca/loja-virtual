$(document).ready(function(){function e(){return $.ajax({url:"/carrinho/getDadosCarrinho",dataType:"json",success:function(e){numeral.language("pt-br"),n.html(e.numeroProdutosCarrinho),r.html(numeral(e.valorProdutosCarrinho).format("$0,0.00"))}})}var t=$("#main_content"),a=t.find(".center_content"),o=t.find(".shopping_cart"),n=o.find("#products_cart"),r=o.find(".price"),i=a.find(".btn-add-carrinho"),d=t.find(".btn-alterar-quantidade"),c=t.find(".btn-remover-produto");i.on("click",function(t){t.preventDefault();var a=$(this).attr("data-id");$.ajax({url:"/carrinho/add/"+a,type:"POST",success:function(t){e()}})}),d.on("click",function(e){e.preventDefault();var t=$(this).closest("tr").find(".input_quantidade").val(),a=$(this).attr("data-id");$.ajax({url:"/carrinho/update",data:"id="+a+"&qtd="+t,type:"post",success:function(e){"semEstoque"==e&&(alertDefault("warning","Produto sem estoque","Esse produto não está mais em estoque"),setTimeout(function(){location.reload()},1e3)),"updated"!=e&&"deleted"!=e||location.reload()}})}),c.on("click",function(e){e.preventDefault();var t=$(this).attr("data-id");$.ajax({url:"/carrinho/delete",data:"id="+t,type:"post",success:function(e){"deleted"==e&&location.reload()}})})}),function(){var e=$("#main_content"),t=e.find(".center_content"),a=t.find("#message"),o=t.find("#email_esqueci_senha"),n=t.find("#btn-esqueci-senha");n.on("click",function(e){e.preventDefault();var t=o.val();$.ajax({url:"/esqueci/send",data:"email="+t,type:"post",beforeSend:function(){a.html("Recuperando dados, aguarde")},success:function(e){a.html(""),"erro"==e&&(location.reload(),o.val("")),"user"==e&&(alertDefault("warning","Usuário não encontrado","Não encontramos seu email em nossa base de dados."),o.val("")),"enviado"==e&&(alertDefault("success","Email enviado","Enviamos um email para o email digitado, clique no link e atualize sua senha"),o.val(""))}})})}(),$(document).ready(function(){var e=$("#main_content"),t=e.find(".center_content"),a=t.find("#btn-fechar-pedido"),o=t.find("#input-frete");a.on("click",function(e){e.preventDefault(),$.ajax({url:"/checkout",dataType:"json",beforeSend:function(){$(a).text("Fechando pedido...")},success:function(e){"empty"==e&&($(a).text("Fechar pedido"),alertDefault("warning","Carrinho Vazio","Você precisa ter produtos no carrinho para fechar o pedido")),"notLoggedIn"==e&&($(a).text("Fechar pedido"),alertNotLoggedIn("Não está logado","Você precisa estar logado para fechar o pedido")),"frete"==e&&($(a).text("Fechar pedido"),$(o).focus(),alertDefault("warning","Problema no Frete","Antes de fechar o pedido você deve calcular o frete")),"sim"==e.redirecionar&&(alertDefault("success","Pedido Fechado !","Em 5 segundos você será redirecionado para finalizar a sua compra"),setTimeout(function(){window.location.href=e.url},3e3)),"erroCadastro"==e.redirecionar&&alertDefault("error","Ocorreu um erro !","Ocorreu um erro ao tentar fechar o pedido, tente novamente, caso não consiga fechar o pedido, entre em contato conosco")}})})}),$(document).ready(function(){var e=$("#main_content"),t=e.find("#btn-calcular-frete"),a=e.find("#input-frete"),o=e.find("#mensagem-frete");t.on("click",function(e){e.preventDefault();var t=a.val();$.ajax({url:"/frete/calcular",type:"post",data:"frete="+t,dataType:"json",beforeSend:function(){o.html("Calculando o frete")},success:function(e){"login"==e&&(alertNotLoggedIn("Não está logado !","Você precisa estar logado para calcular o frete"),o.html("")),"produto"==e&&(alertDefault("warning","Nenhum produto no carrinho !","Você precisa ter produtos no carrinho para calcular o frete."),o.html("")),"sim"==e.erro&&(alertDefault("warning",e.mensagem),o.html("")),"nao"==e.erro&&location.reload()}})})}),numeral.language("pt-br",{delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){return 1===e?"er":"ème"},currency:{symbol:"R$ "}}),function(){var e=$("#main_content"),t=e.find(".btn-ver-pedido");t.on("click",function(e){e.preventDefault();var t=$(this).attr("data-id");$.ajax({url:"/pedidos/show/"+t,type:"post",dataType:"json",beforeSend:function(){},success:function(e){var t='<table class="ui very basic collapsing celled table">';t+="<thead>",t+="<tr><th></th>",t+="<th>Produto</th>",t+="<th>Valor</th>",t+="<th>Qtde</th>",t+="<th>Subtotal</th>",t+="</tr>",t+="</thead>",t+="<tbody>",numeral.language("pt-br"),$.each(e,function(e,a){t+="<tr>",t+='<td><img src="'+a.produtos.produto_foto+'" width="30" height="30"></td>',t+="<td>"+a.produtos.produto_nome+"</td>",t+="<td>"+numeral(a.valor).format("$0,0.00")+"</td>",t+="<td>"+a.qtd+"</td>",t+="<td>"+numeral(a.subtotal).format("$0,0.00")+"</td>",t+="</tr>"}),t+="</tbody>",t+="</table>",alertHtml("<h2>Meu Pedido</h2>",t,"ver-pedidos")}})})}();